# Sync Tasks

Update the project dashboard (dashboard.md) from task JSON files.

## Usage
```
/sync-tasks
```

## Process

1. Read all `.claude/tasks/task-*.json` files (active tasks only)
2. Read all `.claude/tasks/milestone-*.json` files (if any exist)
3. Calculate statistics by owner and status
4. **Preserve user notes section** (content between `<!-- USER SECTION -->` markers)
5. Generate dashboard with:
   - Quick Status (counts)
   - Upcoming Deadlines (tasks with due_date)
   - Milestones (if any exist)
   - Your Actions / Claude Status sections
   - Progress This Week
   - All Tasks table
6. Add archive summary if tasks have been archived
7. Write to `.claude/dashboard.md`

## Output Format

```markdown
# Dashboard

*Auto-generated by /sync-tasks. Last updated: {date}*

## Quick Status

| Total | Done | â— You | ğŸ¤– Claude | ğŸ‘¥ Both | Blocked |
|-------|------|--------|-----------|---------|---------|
| 15    | 7    | 3      | 4         | 1       | 2       |

*(Counts show pending/actionable tasks per owner, plus blocked across all)*

## â° Upcoming Deadlines

| Due | ID | Task | Owner |
|-----|----|----|-------|
| Tomorrow | 6 | ğŸ”´ Deploy MVP | â— |
| Jan 30 | 7 | ğŸŸ  API docs | ğŸ¤– |

*No deadlines set* (shown when no tasks have due_date)

## ğŸ¯ Milestones

| Target | Milestone | Progress |
|--------|-----------|----------|
| Feb 1  | MVP Complete | 3/8 tasks (37%) |
| Feb 15 | Beta Launch | 0/5 tasks |

*(Only shown when milestone files exist)*

## â— Your Actions

### Ready Now
| ID | Task | Difficulty |
|----|------|------------|
| 5  | ğŸ”´ Configure API keys | 2 |

### Waiting On Claude
| ID | Task | Blocked By |
|----|------|------------|
| 8  | Deploy to production | #7 (Claude building API) |

### External Dependencies
| ID | Task | Type | Expected |
|----|------|------|----------|
| 12 | Setup vendor API | vendor | Jan 28 |

## ğŸ¤– Claude Status

### In Progress
| ID | Task |
|----|------|
| 7  | Build REST API |

### Ready to Start
| ID | Task | Difficulty |
|----|------|------------|
| 9  | ğŸŸ  Write unit tests | 4 |
| 10 | Write docs | 3 |

### Blocked
| ID | Task | Blocked By |
|----|------|------------|
| 11 | Integration tests | #9 (unit tests) |

## ğŸ“Š Progress This Week

| Completed | Started | Created |
|-----------|---------|---------|
| 5 tasks   | 2 tasks | 3 tasks |

Recent completions:
- #12 Add user validation (Jan 25)
- #8 Setup database (Jan 24)

## ğŸ’¡ Notes & Ideas

<!-- USER SECTION - Claude preserves this on sync -->

[Your notes here - add ideas, questions, reminders]

<!-- END USER SECTION -->

---

## All Tasks

| ID | Title | Status | Diff | Owner | Due | Deps |
|----|-------|--------|------|-------|-----|------|
| 1  | Setup project | Finished | 3 | ğŸ¤– | - | - |
| 5  | Configure keys | Pending | 2 | â— | Jan 27 | - |
| 7  | Build REST API | In Progress | 5 | ğŸ¤– | Feb 1 | - |
| 8  | Deploy to prod | Pending | 3 | â— | Feb 5 | #7 |

*Summary: 7/15 complete (47%)*
```

## Owner Field

See `shared-definitions.md` for full owner definitions. Summary:
- `claude` (default) â†’ ğŸ¤– Claude Status
- `human` â†’ â— Your Actions
- `both` â†’ ğŸ‘¥ Appears in BOTH sections with ğŸ‘¥ marker

## Ready vs Blocked Logic

**Ready Now**: Task is `Pending` AND all dependencies are `Finished`

**Waiting/Blocked**: Task is `Pending` AND has unfinished dependencies

## Priority Display

Tasks in Ready sections are sorted by priority (critical â†’ high â†’ medium â†’ low).
Only critical and high priorities show emoji prefixes:

| Priority | Prefix |
|----------|--------|
| critical | ğŸ”´ |
| high | ğŸŸ  |
| medium | (none) |
| low | (none) |

## Upcoming Deadlines Section

Shows tasks with `due_date` field set, sorted by date:
- "Today", "Tomorrow", or date format (Jan 30)
- Owner shown as emoji (â—/ğŸ¤–/ğŸ‘¥)
- Priority emoji prefix on task title
- Only shows non-finished tasks

## Milestones Section

Only generated when `milestone-*.json` files exist:
- Lists milestones by target_date
- Shows progress as "X/Y tasks (Z%)" based on tasks with matching `milestone` field
- Milestones with all tasks finished show âœ“

## External Dependencies Section

Under "Your Actions", shows tasks with `external_dependency` field:
- Type: permit, vendor, approval, delivery
- Expected date from `external_dependency.expected_date`
- Contact info available in task details

## Progress This Week Section

Calculates from date fields:
- Completed: tasks with `completion_date` in last 7 days
- Started: tasks with `updated_date` in last 7 days that moved to In Progress
- Created: tasks with `created_date` in last 7 days

Lists recent completions with task ID, title, and completion date.

## User Notes Preservation

The `<!-- USER SECTION -->` block is preserved across syncs:
1. Before generating, extract existing user section content
2. After generating, insert preserved content back
3. If no user section exists, create empty template

## When to Run
- After completing any task
- After breaking down a task
- When starting a work session
- After archiving tasks
